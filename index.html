<!DOCTYPE html>
<html lang="he">
<head>
Â  <meta charset="UTF-8">
Â  <title>×¡×™×›×•× × ×™×§×•×“ ×©×•×¤×˜×™× ×•×§×”×œ</title>
Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  direction: rtl;
Â  Â  Â  padding: 20px;
Â  Â  Â  background-color: #f4f4f4;
Â  Â  }
Â  Â  .controls {
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  #charts-container {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: nowrap; /* *×—×•×‘×”: ×©×•××¨ ××•×ª× ×ª××™×“ ×‘×©×•×¨×” ××—×ª* */
Â  Â  Â  overflow-x: auto; Â /* *×××¤×©×¨ ×’×œ×™×œ×” ××•×¤×§×™×ª ×× ××™×Ÿ ××§×•×* */
Â  Â  Â  gap: 20px;
Â  Â  Â  padding-bottom: 10px;
Â  Â  Â  align-items: flex-start; /* ×™×™×©×•×¨ ×”×ª×¨×©×™××™× ×œ×—×œ×§ ×”×¢×œ×™×•×Ÿ */
Â  Â  }
Â  Â  .chart-box {
Â  Â  Â  /* ×”×’×“×¨×•×ª ×¨×•×—×‘ ×§×‘×•×¢×•×ª ×›×“×™ ×œ×× ×•×¢ ××¢×‘×¨ ×©×•×¨×” */
Â  Â  Â  flex-shrink: 0; /* ××•× ×¢ ××”×ª×¨×©×™× ×œ×”×ª×›×•×•×¥ */
Â  Â  Â  flex-grow: 0; /* ××•× ×¢ ××”×ª×¨×©×™× ×œ×’×“×•×œ */
Â  Â  Â  flex-basis: 350px; /* ×¨×•×—×‘ ×”×‘×¡×™×¡ ×©×œ ×›×œ ×ª×¨×©×™× */
Â  Â  Â  
Â  Â  Â  min-width: 350px; /* *×¨×•×—×‘ ××™× ×™××œ×™ ×§×‘×•×¢ ×›×“×™ ×œ×× ×•×¢ ×”×ª×›×•×•×¦×•×ª* */
Â  Â  Â  max-width: 350px; /* *×¨×•×—×‘ ××§×¡×™××œ×™ ×§×‘×•×¢ ×›×“×™ ×œ×× ×•×¢ ×’×“×™×œ×”* */

Â  Â  Â  background: white;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  padding: 15px;
Â  Â  Â  box-shadow: 0 0 10px rgba(0,0,0,0.1);
Â  Â  Â  height: 450px; /* ×’×•×‘×” ×§×‘×•×¢ ×œ-chart-box */
Â  Â  Â  box-sizing: border-box;

Â  Â  Â  /* ×›×“×™ ×©×”×§× ×‘×¡ ×™×ª××§× × ×›×•×Ÿ ×‘×ª×•×›×• */
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  }
Â  Â  
Â  Â  button {
Â  Â  Â  font-size: 16px;
Â  Â  Â  padding: 10px 20px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  margin: 0 10px;
Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  background-color: #007bff;
Â  Â  Â  color: white;
Â  Â  Â  cursor: pointer;
Â  Â  }

Â  Â  button:hover {
Â  Â  Â  background-color: #0056b3;
Â  Â  }
Â  Â  canvas {
Â  Â  Â  width: 100% !important; 
Â  Â  Â  height: 100% !important; /* ×××œ× ××ª ×”×’×•×‘×” ×©×œ chart-box */
Â  Â  Â  max-height: 400px; /* ×©×•××¨ ×¢×œ ×’×•×‘×” ×¡×‘×™×¨ ×‘×ª×•×š ×”-chart-box */
Â  Â  }
Â  Â  .leader {
Â  Â  Â  border: 3px solid #ff0000;
Â  Â  Â  box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
Â  Â  }
Â  </style>
</head>
<body>
Â  Â  <h1 style="text-align:center; margin-top: 20px; font-size: 28px; font-family: Arial;">×¡×™×›×•× × ×™×§×•×“ ×©×•×¤×˜×™× ×•×§×”×œ</h1>

<div class="controls">
Â  <button onclick="fetchGoogleSheetData()">ğŸ”„ ×¨×¢× ×Ÿ × ×ª×•× ×™× ××’×™×œ×™×•×Ÿ ×’×•×’×œ</button>
</div>

<div id="charts-container"></div>

<script>
// ×›×ª×•×‘×ª ×”-URL ×©×œ ×’×™×œ×™×•×Ÿ ×’×•×’×œ ×©×¤×•×¨×¡× ×›-CSV
const GOOGLE_SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSTToy2f936VEdbQMk3zM9drEvaUeaBajHFsAn1BxMID1j43j8l5T8wwZ-UN5HyfboSAYz4K5UAxCxs/pub?output=csv';

let parsedData = null;

function fetchGoogleSheetData() {
Â  Papa.parse(GOOGLE_SHEET_CSV_URL, {
Â  Â  download: true,
Â  Â  header: true,
Â  Â  skipEmptyLines: true,
Â  Â  complete: function(results) {
Â  Â  Â  parsedData = results.data;
Â  Â  Â  console.log("× ×ª×•× ×™× ×©× ×˜×¢× ×• ××’×™×œ×™×•×Ÿ ×’×•×’×œ:", parsedData);
Â  Â  Â  if (parsedData && parsedData.length > 0) {
Â  Â  Â  Â  drawCharts(parsedData);
Â  Â  Â  } else {
Â  Â  Â  Â  alert("×œ× ×”×¦×œ×—× ×• ×œ×˜×¢×•×Ÿ × ×ª×•× ×™× ××’×™×œ×™×•×Ÿ ×’×•×’×œ, ××• ×©×”×’×™×œ×™×•×Ÿ ×¨×™×§. ×•×“× ×©×”×§×™×©×•×¨ ×ª×§×™×Ÿ ×•×”×’×™×œ×™×•×Ÿ ×¤×•×¨×¡× ×›-CSV ×•××›×™×œ × ×ª×•× ×™×.");
Â  Â  Â  }
Â  Â  },
Â  Â  error: function(err, file) {
Â  Â  Â  console.error("×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™×:", err, file);
Â  Â  Â  alert("××™×¨×¢×” ×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™× ××’×™×œ×™×•×Ÿ ×’×•×’×œ. ×× × ×‘×“×•×§ ××ª ×§×•× ×¡×•×œ×ª ×”××¤×ª×—×™× ×œ×¤×¨×˜×™× × ×•×¡×¤×™×.");
Â  Â  }
Â  });
}

function drawCharts(data) {
Â  const container = document.getElementById('charts-container');
Â  container.innerHTML = '';

Â  let maxVal = 0;
Â  data.forEach(row => {
Â  Â  const val1 = parseFloat(row.Value_1) || 0;
Â  Â  const val2 = parseFloat(row.Value_2) || 0;
Â  Â  const sum = val1 + val2;
Â  Â  maxVal = Math.max(maxVal, val1, val2, sum);
Â  });
Â  const scaleMax = Math.ceil(maxVal * 1.1);

Â  data.forEach((row, index) => {
Â  Â  if (!row.Chart_Title || !row.Label_1 || !row.Label_2 || !row.Value_1 || !row.Value_2) {
Â  Â  Â  console.warn(`×©×•×¨×” ${index + 2} (×›×•×œ×œ ×›×•×ª×¨×•×ª) ×—×¡×¨×” × ×ª×•× ×™× ×•× ×“×œ×’×ª:`, row);
Â  Â  Â  return;
Â  Â  }

Â  Â  const title = row.Chart_Title || `×ª×¨×©×™× ${index + 1}`;
Â  Â  const label1 = row.Label_1 || '×§×”×œ';
Â  Â  const label2 = row.Label_2 || '×©×•×¤×˜×™×';
Â  Â  const val1 = parseFloat(row.Value_1) || 0;
Â  Â  const val2 = parseFloat(row.Value_2) || 0;
Â  Â  const total = val1 + val2;

Â  Â  const canvas = document.createElement('canvas');
Â  Â  const chartBox = document.createElement('div');
Â  Â  chartBox.className = 'chart-box';
Â  Â  chartBox.appendChild(canvas);
Â  Â  container.appendChild(chartBox);

Â  Â  new Chart(canvas.getContext('2d'), {
Â  Â  Â  type: 'bar',
Â  Â  Â  data: {
Â  Â  Â  Â  labels: [label1, label2, '×¡×”"×›'],
Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  label: title,
Â  Â  Â  Â  Â  data: [val1, val2, total],
Â  Â  Â  Â  Â  backgroundColor: ['#42a5f5', '#66bb6a', '#ffa726']
Â  Â  Â  Â  }]
Â  Â  Â  },
Â  Â  Â  options: {
Â  Â  Â  Â  responsive: true,
Â  Â  Â  Â  maintainAspectRatio: false,
Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  y: {
Â  Â  Â  Â  Â  Â  suggestedMax: scaleMax,
Â  Â  Â  Â  Â  Â  beginAtZero: true
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  plugins: {
Â  Â  Â  Â  Â  legend: { display: false },
Â  Â  Â  Â  Â  title: {
Â  Â  Â  Â  Â  Â  display: true,
Â  Â  Â  Â  Â  Â  text: title,
Â  Â  Â  Â  Â  Â  font: { size: 18 }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  });
Â  });
}

// ×§×¨×™××” ×¨××©×•× ×™×ª ×œ×˜×¢×™× ×ª ×”× ×ª×•× ×™× ×›×©×“×£ × ×˜×¢×Ÿ
document.addEventListener('DOMContentLoaded', fetchGoogleSheetData);
</script>
×§×¢××¤ ×§×™×¥ 2015 â’¸
</body>
</html>
